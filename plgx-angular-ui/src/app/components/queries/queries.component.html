
<div class="kt-grid kt-grid--hor kt-grid--root">
  <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--ver kt-page">
    <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor kt-wrapper" id="kt_wrapper">


<div class="kt-portlet kt-portlet--mobile kt-portlet--responsive-mobile no-mar-botom">
<div class="kt-portlet__head kt-portlet__head--lg">
<div class="kt-portlet__head-label">
  <span class="kt-portlet__head-icon">
    <i class="kt-font-brand fa fa-layer-group"></i>
  </span>
  <h3 class="kt-portlet__head-title">
    Queries
  </h3>
  <div class="">
      <ul class="nav nav-pills nav-pills-sm nav-pills-label nav-pills-bold" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" style="cursor: pointer;" data-toggle="tab"  (click)="type_query(dataval_packs,'associated_packs_id')" role="tab">Associated with Packs</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" style="cursor: pointer;" data-toggle="tab" (click)="type_query(dataval_all,'all_queries_id')" role="tab">All Queries</a>
        </li>
      </ul>
    </div>
</div>

<div class="kt-portlet__head-toolbar">
  <div class="kt-portlet__head-wrapper">
    <div class="">

      <!-- <button type="button" class="btn btn-outline-success btn-sm" data-toggle="modal" data-target="#add_pack" aria-haspopup="true" aria-expanded="false"> -->
      <a [routerLink]="['./add-query']" class="btn btn-outline-success btn-icon-sm">
        <i class="fa fa-plus-square"></i>
        Add Query
        <!-- </button> -->
      </a>
    </div>
  </div>
</div>
</div>
<div class="no_data_all" style="text-align: center;margin-top: 10px;display: none;"> No Queries Present</div>
<div class="no_data" style="text-align: center;margin-top: 10px;"> No Queries Associated with Packs</div>
<div class="kt-portlet__body present_data">
<!-- {% if queries %} -->
<!--Begin:: Content -->
<div class="kt-content">
  <div class="row">
    <div class="col-md-4">
      <!--begin::Portlet-->
      <div class="kt-portlet no-mar-botom portlet-body_align">
        <div class="queries_body2">
          <div class="ph-item" style="height: 565px; margin-bottom:25px;">
          <div class="ph-col-12">
          <div class="ph-row">
            <div class="ph-col-4 big"></div>
            <div class="ph-col-8 empty big"></div>
            <div class="ph-col-6 big"></div>
            <div class="ph-col-6 empty big"></div>
            <div class="ph-col-2 big"></div>
            <div class="ph-col-10 empty big"></div>
            <div class="ph-col-6 big"></div>
            <div class="ph-col-6 empty big"></div>
            </div>
            <div class="ph-row">
              <div class="ph-col-4 big"></div>
              <div class="ph-col-8 empty big"></div>
              <div class="ph-col-6 big"></div>
              <div class="ph-col-6 empty big"></div>
              <div class="ph-col-2 big"></div>
              <div class="ph-col-10 empty big"></div>
              <div class="ph-col-6 big"></div>
              <div class="ph-col-6 empty big"></div>
              </div>
              <div class="ph-row">
                <div class="ph-col-4 big"></div>
                <div class="ph-col-8 empty big"></div>
                <div class="ph-col-6 big"></div>
                <div class="ph-col-6 empty big"></div>
                <div class="ph-col-2 big"></div>
                <div class="ph-col-10 empty big"></div>
                <div class="ph-col-6 big"></div>
                <div class="ph-col-6 empty big"></div>
                </div>
                <div class="ph-row">
                  <div class="ph-col-4 big"></div>
                  <div class="ph-col-8 empty big"></div>
                  </div>
              </div>
            </div>
        </div>
        <div *ngIf="id_to_get_particular_queries=='all_queries_id'" class="kt-portlet__body" style="padding: 0px;">
          <!--begin: Search Table -->
          <div class="">
            <div class="kt-input-icon kt-input-icon--left" style="margin-bottom: 10px;">
              <input type="text" class="form-control" placeholder="Search Queries here..." id="search_query_name" [(ngModel)]="searchText">
              <span class="kt-input-icon__icon kt-input-icon__icon--left">
                <span><i class="la la-search"></i></span>
              </span>
            </div>

          </div>
          <!--end: Search Table -->
          
          <!--begin::Notifications-->
          <div class="queries_body"  style="height: 565px; overflow-x:scroll; margin-bottom:25px;">
            <!-- {% for query in queries | sort (attribute='name') %} -->
               <div *ngFor="let query of (sorted_pack_data_name_id  | querysearch:searchText)as result" class="kt-notification conf-div" id="search_query-name-list" style="cursor:pointer; " data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="{{query[0]}}">
                <div *ngIf="query === -1">No Matching Record Found</div>
                <div *ngIf="query != -1"> 
                <div class="kt-notification__item-title list-group"  [ngClass]="{'active': selectedItem == query[1]}"   (click)='getById_all_queries($event, query[1],query[1])' >
                 <a data-target="{{query[1]}}" class="kt-notification__item conf-link-query">
                  <div class="kt-notification__item-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon">
                      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <rect id="bound" x="0" y="0" width="24" height="24" />
                        <path
                          d="M10.5,5 L20.5,5 C21.3284271,5 22,5.67157288 22,6.5 L22,9.5 C22,10.3284271 21.3284271,11 20.5,11 L10.5,11 C9.67157288,11 9,10.3284271 9,9.5 L9,6.5 C9,5.67157288 9.67157288,5 10.5,5 Z M10.5,13 L20.5,13 C21.3284271,13 22,13.6715729 22,14.5 L22,17.5 C22,18.3284271 21.3284271,19 20.5,19 L10.5,19 C9.67157288,19 9,18.3284271 9,17.5 L9,14.5 C9,13.6715729 9.67157288,13 10.5,13 Z"
                          id="Combined-Shape" fill="#000000" />
                        <rect id="Rectangle-7-Copy-2" fill="#000000" opacity="0.3" x="2" y="5" width="5" height="14" rx="1" />
                      </g>
                    </svg>
                  </div>
                  <div class="kt-notification__item-details">
          
                      {{query[0]}}
                
                  </div>
                 </a>
                 </div>
                 </div>
              </div>
            </div>
            <!-- {% endfor %} -->
          </div>
          <div  *ngIf="id_to_get_particular_queries=='associated_packs_id'" class="kt-portlet__body" style="padding: 0px;">
            <!--begin: Search Table -->
            <div class="">
              <div class="kt-input-icon kt-input-icon--left" style="margin-bottom: 10px;">
                <input type="text" class="form-control" placeholder="Search Queries here..." id="search_query_name" [(ngModel)]="searchText">
                <span class="kt-input-icon__icon kt-input-icon__icon--left">
                  <span><i class="la la-search"></i></span>
                </span>
              </div>
  
            </div>
            <!--end: Search Table -->
            
            <!--begin::Notifications-->
            <div class="queries_body"  style="height: 565px; overflow-x:scroll; margin-bottom:25px;">
              <!-- {% for query in queries | sort (attribute='name') %} -->
                 <div *ngFor="let query of (sorted_pack_data_name_id  | querysearch:searchText)as result" class="kt-notification conf-div" id="search_query-name-list" style="cursor:pointer; " data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="{{query[0]}}">
                  <div *ngIf="query === -1">No Matching Record Found</div>
                  <div *ngIf="query != -1"> 
                  <div class="kt-notification__item-title list-group"  [ngClass]="{'active': selectedItem == query[1]}"   (click)='getById_associated_queries($event, query[1],query[1])' >
                   <a data-target="{{query[1]}}" class="kt-notification__item conf-link-query">
                    <div class="kt-notification__item-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon">
                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                          <rect id="bound" x="0" y="0" width="24" height="24" />
                          <path
                            d="M10.5,5 L20.5,5 C21.3284271,5 22,5.67157288 22,6.5 L22,9.5 C22,10.3284271 21.3284271,11 20.5,11 L10.5,11 C9.67157288,11 9,10.3284271 9,9.5 L9,6.5 C9,5.67157288 9.67157288,5 10.5,5 Z M10.5,13 L20.5,13 C21.3284271,13 22,13.6715729 22,14.5 L22,17.5 C22,18.3284271 21.3284271,19 20.5,19 L10.5,19 C9.67157288,19 9,18.3284271 9,17.5 L9,14.5 C9,13.6715729 9.67157288,13 10.5,13 Z"
                            id="Combined-Shape" fill="#000000" />
                          <rect id="Rectangle-7-Copy-2" fill="#000000" opacity="0.3" x="2" y="5" width="5" height="14" rx="1" />
                        </g>
                      </svg>
                    </div>
                    <div class="kt-notification__item-details">
            
                        {{query[0]}}
                  
                    </div>
                   </a>
                   </div>
                   </div>
                </div>
              </div>
              <!-- {% endfor %} -->
            </div>
          <!--End::Notifications-->

        </div>
      </div>
      <!--end::Portlet-->

    <div class="col-md-8">
      <!--begin::Portlet-->
      <!-- {% for query in queries %} -->
        <div  class="right-conf-query kt-portlet no-mar-botom portlet-body_align__table" id="{{query_data?.id}}">
          <div class="queries_body2" >
            <div class="kt-portlet__head ph-item" style="padding: 14px 15px 3px 13px;margin-bottom: 1px;">
              <div class="ph-col-12">
                <div class="ph-row">
                  <div class="ph-col-6 big"></div>
                 </div>
                </div>
            </div>
          </div>

          <div class="kt-portlet__head queries_body">
            <div class="kt-portlet__head-label">
              <span class="kt-portlet__head-icon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon">
                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                    <rect id="bound" x="0" y="0" width="24" height="24" />
                    <path
                      d="M10.5,5 L20.5,5 C21.3284271,5 22,5.67157288 22,6.5 L22,9.5 C22,10.3284271 21.3284271,11 20.5,11 L10.5,11 C9.67157288,11 9,10.3284271 9,9.5 L9,6.5 C9,5.67157288 9.67157288,5 10.5,5 Z M10.5,13 L20.5,13 C21.3284271,13 22,13.6715729 22,14.5 L22,17.5 C22,18.3284271 21.3284271,19 20.5,19 L10.5,19 C9.67157288,19 9,18.3284271 9,17.5 L9,14.5 C9,13.6715729 9.67157288,13 10.5,13 Z"
                      id="Combined-Shape" fill="#000000" />
                    <rect id="Rectangle-7-Copy-2" fill="#000000" opacity="0.3" x="2" y="5" width="5" height="14" rx="1" />
                  </g>
                </svg>



              </span>
             
              <h3 class="kt-portlet__head-title">
                    <!-- App_ExecuteOptions -->
                {{query_data?.name}}
              </h3>
            </div>
            <div class="kt-portlet__head-toolbar">              
              <div class="kt-portlet__head-actions">
                <a [routerLink] = "['./',queryid,'edit']" class="btn btn-clean btn-sm btn-icon btn-icon-md" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="Edit Query">
                  <i class="far fa-edit"></i>
                </a>
              </div>
              <div class="kt-portlet__head-actions" style="margin-top: 5px;">
                <i style="color: #fa0303;cursor: pointer;" (click) ="deleteQueries(query_data.id, query_data.name)" title="Delete Query " class="fa fa fa-trash-alt"></i>
              </div>
             </div>
          </div>
          <div class="right-conf-card kt-portlet__body queries_body2" style="height: 565px; overflow-x:scroll; margin-bottom:25px; padding: 1.25rem;">
            <div class="ph-item">
            <div class="ph-col-12">
            <div class="ph-row">
              <div class="ph-col-4 big"></div>
              <div class="ph-col-8 empty big"></div>
              <div class="ph-col-6 big"></div>
              <div class="ph-col-6 empty big"></div>
              <div class="ph-col-2 big"></div>
              <div class="ph-col-10 empty big"></div>
              <div class="ph-col-6 big"></div>
              <div class="ph-col-6 empty big"></div>
              </div>
              <div class="ph-row">
                <div class="ph-col-4 big"></div>
                <div class="ph-col-8 empty big"></div>
                <div class="ph-col-6 big"></div>
                <div class="ph-col-6 empty big"></div>
                <div class="ph-col-2 big"></div>
                <div class="ph-col-10 empty big"></div>
                <div class="ph-col-6 big"></div>
                <div class="ph-col-6 empty big"></div>
                </div>
                <div class="ph-row">
                  <div class="ph-col-4 big"></div>
                  <div class="ph-col-8 empty big"></div>
                  <div class="ph-col-6 big"></div>
                  <div class="ph-col-6 empty big"></div>
                  <div class="ph-col-2 big"></div>
                  <div class="ph-col-10 empty big"></div>
                  <div class="ph-col-6 big"></div>
                  <div class="ph-col-6 empty big"></div>
                  </div>
                </div>
              </div>
          </div>
          <div class="right-conf-card kt-portlet__body queries_body" style="height: 565px; overflow-x:scroll; margin-bottom:25px; padding: 1.25rem;">

              <div class="">
                <table class="table table-striped- table-bordered table-hover table-checkable">
                  <tbody>
                    <tr>
                      <td class="head-table-query">Query</td>
                      <td class="conf-table-val">
                        <div class="sql hljs desc-background-query">
                            <span class="hljs-keyword">{{query_data?.sql}}</span>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td class="head-table-query">Interval</td>
                      <td class="conf-table-val">
                        <div class="desc-background-query">{{query_data?.interval}}</div>
                      </td>
                    </tr>
                    <tr>
                      <td class="head-table-query">Platform</td>
                      <td class="conf-table-val">
                        <div class="desc-background-query">{{query_data?.platform}}
                        <span class="col-md-1"></span>
                        <button (click)="runAdHoc(query_data?.id)" class="btn-success"> Run Live </button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td class="head-table-query">Description</td>
                      <td class="conf-table-val">
                        <span class="desc-background-query truncate_query">{{query_data?.description}}</span>
                      </td>
                    </tr>

                    <tr>
                      <td class="head-table-query">Version</td>
                      <td>
                      {{query_data?.version}}

                      </td>
                    </tr>
                    <!-- {% endif %} -->

                    <tr>
                      <td class="head-table-query">Value</td>
                      <td>
                      {{query_data?.value}}

                      </td>
                    </tr>
                    <!-- {% endif %} -->
                    <tr>
                      <td class="head-table-query">Packs</td>
                      
                      <td>
                        <!-- <span class="label" routerLink="./../packs" style="color:blue;cursor:pointer">{{query_data.packs}}</span> -->
                        <span class="label_pack"style="color:#6371df;font-size: 12px;font-weight: 700;cursor: pointer;word-break: break-word;" *ngFor="let pack_name of query_data?.packs">
                          <a routerLink="./../packs" >{{pack_name}}</a>
                          </span>
                          

                        <!-- <span class="label">

                        </span> -->
                        <!-- {% endfor %} -->
                      </td>
                    </tr>
                    <!-- {% if not hide_query_tags %} -->
                    <tr>
                      <td class="head-table-query">Tags</td>
                      <td>                        
                        <tag-input *ngIf ="query_data" [theme]="'foundation-theme'"  [placeholder]="'Add tags here...'" [(ngModel)]='query_data.tags' (onAdd)="queries_addTag(query_data.tags,query_data.id)" (onRemove)="queries_removeTag($event,query_data.id)" [modelAsStrings]="true"></tag-input>
                      </td>

                    </tr>
                    <!-- {% endif %} -->
                    <tr>
                      <td class="head-table-query">Snapshot</td>
                      <td>
                      {{query_data?.snapshot}}

                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      <!-- {% endfor %} -->
      <!--end::Portlet-->
    </div>
  </div>
</div>
 <!-- {% else %} -->
  <div class="kt-content">
    <div class="container">
      <div class="row">
        <!-- <p style="margin-top:50px;">No queries created. Click on add query to create one</p> -->
      </div>
    </div>
  </div>
<!-- {% endif %} -->
<!--Begin:: Content -->

</div>
</div>
</div>
</div>
<!-- end:: Content -->
